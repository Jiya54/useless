<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Time Wasted Tracker</title>
  <style>
    body {
      background-color: #121212;
      color: #e0e0e0;
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
      padding: 30px;
      margin: 0;
    }

    h1, h2 {
      text-align: center;
      color: #ff9800;
    }

    form {
      background-color: #1e1e1e;
      padding: 20px;
      max-width: 400px;
      margin: 0 auto 30px auto;
      border-radius: 10px;
      box-shadow: 0 0 10px #000;
    }

    label {
      display: block;
      margin-bottom: 15px;
      font-size: 14px;
    }

    input {
      width: 100%;
      padding: 10px;
      margin-top: 5px;
      border-radius: 5px;
      border: none;
      background-color: #2c2c2c;
      color: white;
    }

    button {
      background-color: #ff9800;
      color: black;
      padding: 10px 20px;
      border: none;
      border-radius: 5px;
      cursor: pointer;
      width: 100%;
    }

    button:hover {
      background-color: #ffa733;
    }

    .session-card {
      background-color: #1e1e1e;
      padding: 15px;
      border-radius: 8px;
      margin: 10px auto;
      max-width: 500px;
      box-shadow: 0 0 5px #333;
    }

    .session-card p {
      margin: 5px 0;
    }

    .session-card button {
      background-color: #ff5252;
      color: white;
      border: none;
      border-radius: 5px;
      padding: 5px 10px;
      cursor: pointer;
    }

    .session-card button:hover {
      background-color: #ff7777;
    }
  </style>
</head>
<body>
  <h1>‚è≥ Time Wasted Tracker</h1>

  <form id="sessionForm">
    <label>Username:
      <input type="text" id="username" required />
    </label>
    <label>Activity:
      <input type="text" id="activity" required />
    </label>
    <label>Duration (in minutes):
      <input type="number" id="duration" required />
    </label>
    <button type="submit">Submit</button>
  </form>

  <h2>üî• Past Sessions:</h2>
  <div id="result"></div>

  <script>
    const form = document.getElementById("sessionForm");
    const resultDiv = document.getElementById("result");

    const API_URL = "http://localhost:5000/api/session";

    // Handle form submission
    form.addEventListener("submit", async (e) => {
      e.preventDefault();

      const username = document.getElementById("username").value.trim();
      const activity = document.getElementById("activity").value.trim();
      const duration = parseInt(document.getElementById("duration").value);

      if (!username || !activity || isNaN(duration)) {
        alert("Please fill in all fields correctly.");
        return;
      }

      try {
        const res = await fetch(API_URL, {
          method: "POST",
          headers: { "Content-Type": "application/json" },
          body: JSON.stringify({ username, activity, duration }),
        });

        const data = await res.json();
        console.log("Session logged:", data);

        form.reset();
        fetchSessions();
      } catch (err) {
        console.error("Error submitting session:", err);
        alert("Failed to submit. Try again.");
      }
    });

    // Fetch and display past sessions
    async function fetchSessions() {
      try {
        const res = await fetch(API_URL);
        const sessions = await res.json();

        resultDiv.innerHTML = "";

        if (sessions.length === 0) {
          resultDiv.innerHTML = "<p>No sessions yet. Start wasting time üòé</p>";
          return;
        }

        const extraRoasts = [
  "This could‚Äôve been productive, but no.",
  "Legend says you're still wasting time.",
  "Even your cat is more productive.",
  "If time was money, you're broke.",
  "Future you is filing a complaint.",
  "A potato has better time management.",
  "Please stop... even the server is cringing.",
  "Elon is disappointed.",
  "Productivity left the chat.",
  "Netflix called ‚Äî they said thanks for your service.",
  "Your ancestors are watching‚Ä¶ and shaking their heads.",
  "Not even AI can help you now.",
  "This was a masterclass in procrastination.",
  "Every second here takes your GPA with it.",
  "You‚Äôre not just wasting time ‚Äî you‚Äôre investing in regret.",
  "You could've learned a language by now‚Ä¶ or at least a TikTok dance.",
  "Time traveler from the future: ‚ÄòStill at it, huh?‚Äô",
  "One more session and you unlock ‚ÄòWaster Level: Expert‚Äô",
  "Your screen is tired of your face.",
  "Achievement unlocked: Absolutely Nothing Accomplished!"
];




        sessions.forEach((s) => {
          const div = document.createElement("div");
          div.className = "session-card";
          const roast = extraRoasts[Math.floor(Math.random() * extraRoasts.length)];

          div.innerHTML = `
            <p><strong>${s.username}</strong> wasted <strong>${s.duration} min</strong> on <em>${s.activity}</em></p>
            <p>ü´¢ Roast: ${roast}</p>
            <p>üìÖ ${new Date(s.date).toLocaleString()}</p>
            <button onclick="deleteSession('${s._id}')">üóëÔ∏è Delete</button>
          `;
          resultDiv.appendChild(div);
        });
      } catch (err) {
        console.error("Error fetching sessions:", err);
        resultDiv.innerHTML = "<p>Could not load sessions. Try again later.</p>";
      }
    }

    // Delete session
    async function deleteSession(id) {
      const confirmed = confirm("Are you sure you want to delete this session?");
      if (!confirmed) return;

      try {
        const res = await fetch(`${API_URL}/${id}`, {
          method: "DELETE",
        });

        const data = await res.json();
        console.log("Deleted:", data);

        fetchSessions();
      } catch (err) {
        console.error("Error deleting session:", err);
        alert("Could not delete session. Try again.");
      }
    }

    // Initial fetch on page load
    fetchSessions();
  </script>
</body>
</html>
